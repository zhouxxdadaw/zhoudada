(function(d,c){var a=c.require;function b(e){this.width=e.width;this.height=e.height;this.mask=e.mask;this.titleText=e.titleText;this.content=e.content;this.onRender=e.onRender||function(){};this.num=Math.floor(Math.random()*1000);this.init()}b.prototype.init=function(){if(this.mask){this.createMask()}this.createBody()};b.prototype.createMask=function(){var e=Math.max(document.documentElement.scrollHeight,window.screen.height,document.body.scrollHeight);this.maskDom=d('<div class="mod-layer" id="pass-'+this.num+'"></div>');d("body").append(this.maskDom);this.maskDom.height(e)};b.prototype.show=function(){if(this.mask){this.maskDom.show()}this.domBody.show()};b.prototype.hide=function(){if(this.mask){this.maskDom.hide()}this.domBody.hide()};b.prototype.remove=function(){if(this.mask){this.maskDom.remove()}this.domBody.remove()};b.prototype.createBody=function(){this.domBody=d('<div class="mod-layer-body" id="pass-content'+this.num+'"><div class="mod-layer-body-title"><span>'+this.titleText+'</span><a id="close-'+this.num+'" href="###"></a></div><div class="mod-layer-content"><div class="mod-layer-main"></div></div></div>');d("body").append(this.domBody);this.domBody.css({width:this.width,height:this.height,marginLeft:"-"+(parseInt(this.width)/2)+"px",marginTop:"-"+(parseInt(this.height)/2)+"px"});var e=this.domBody.children(".mod-layer-content");e.height(this.height-this.domBody.children(".mod-layer-body-title").height());if(this.content){e.children(".mod-layer-main").append(this.content);this.show()}this.bind();this.onRender(this)};b.prototype.setContent=function(e){this.domBody.append(e);this.show()};b.prototype.bind=function(){var e=this;d("#close-"+this.num).on("click",function(f){e.hide();f.preventDefault()})};c.define("module/layer",b)})(baidu,window.Pass);(function(h,f){var c=f.require,b=f.require("ui/dialog/confirm"),e={},d;function g(){if(d.visible){d.hide()}}function a(){d=new b()}e.showConfirm=function(j,i){if(h.isNumber(i)){setTimeout(g,i)}if(!d){a()}if(j){d.setContent(j)}return d.show()};e.setEle=function(i){if(!d){a()}d.setTmpl(i)};f.define("module/dialog",e)})(baidu,window.Pass);(function(e,d){var b=d.require,c=b("module/dialog");var a=function(f){this.config=f};a.prototype={render:function(){this._schoolPannel=new Pass.module.layer({titleText:"选择学校",width:600,height:398,mask:true,content:'<div class="dialog_parent" id="school_pannel"></div>'});this.initSchool()},initSchool:function(g,f){var h=this;e.sio.callByServer("https://passport.baidu.com/v2/api/?ucentertownlist&type=2",function(j){if(j.errno=="110000"){var i='<div class="all_city">';e.each(j.data,function(k,l){i+='<span class="city j_city" data="'+k+'">'+l+"</span>"});i+='</div><div class="all_school j_all_school"></div>';if(!h._initSchoolFlag){h._initSchoolFlag=true;document.getElementById("school_pannel").innerHTML=i;h.initprovince("120001");e("#school_pannel").find(".j_city").each(function(){e(this).on("click",function(l){var k=e(l.target).attr("data");if(k){e("#school_pannel").find(".j_all_school").html('<img src="/static/passpc-account/img/loading_bf37cfd7.gif" /> <span>加载中，请稍后...</span>');h.initprovince(k)}})})}}})},initprovince:function(f,i){var h=this,g="https://passport.baidu.com/v2/api/?ucentereducationlist&grade=5&province="+f;e.sio.callByServer(g,function(j){if(j.errno=="110000"){var k="";if(j.data!=""){e.each(j.data,function(l,m){k+='<span class="city j_school" data="'+l+'">'+m+"</span>"})}else{k+='<span class="empty">暂时没有该地的数据</span>'}e("#school_pannel").find(".j_all_school").empty();e(k).appendTo(e("#school_pannel").find(".j_all_school"))}e("#school_pannel").find(".j_school").each(function(){e(this).on("click",function(l){var n=e(l.target).attr("data"),m=e(l.target).html();if(n){h.fire("selectSchool",{schoolCode:n,schoolName:m});h.hide()}})})})},show:function(){if(this._schoolPannel){this._schoolPannel.show()}else{this.render()}this.fire("showSchool")},hide:function(){this._schoolPannel.hide();this.fire("hideSchool")},on:function(h,g){if(!e.isFunction(g)){return this}var i,f=this._listeners_;!f&&(f=this._listeners_={});h.indexOf("on")&&(h="on"+h);!e.isArray(i=f[h])&&(i=f[h]=[]);f[h].unshift({handler:g});return this},fire:function(f,q){var h=function(i,n){this.type=i;this.returnValue=true;this.target=n||null;this.currentTarget=null;this.preventDefault=function(){this.returnValue=false}};f&&(f=new h(f));var j,g,l,o,p=this._listeners_,m=f.type,k=[f].concat(Array.prototype.slice.call(arguments,1));!p&&(p=this._listeners_={});e.extend(f,q||{});f.target=f.target||this;f.currentTarget=this;m.indexOf("on")&&(m="on"+m);e.isFunction(this[m])&&this[m].apply(this,k);(j=this._options)&&e.isFunction(j[m])&&j[m].apply(this,k);if(e.isArray(l=p[m])){for(j=l.length-1;j>-1;j--){o=l[j];o&&o.handler.apply(this,k);o&&o.once&&l.splice(j,1)}}return f.returnValue}};d.define("module/regSchool",a)})(baidu,window.Pass);(function(e,d){if(window.TPL2LOGOURL&&d.options&&(d.options.product in window.TPL2LOGOURL)){e(".mod-header a").attr({href:window.TPL2LOGOURL[d.options.product].url});e(".mod-header img").attr({src:window.TPL2LOGOURL[d.options.product].logo})}e(".mod-header a").css({display:"block"});var c=function(m){if(!d.isSchoolReg){return}var k=m;var f=function(){e(k.getElement("school")).addClass("pass-text-input-error");e(k.getElement("schoolError")).show();e(k.getElement("schoolSucc")).hide()};var j=function(){e(k.getElement("school_placeholder")).hide();e(k.getElement("school")).removeClass("pass-text-input-error");e(k.getElement("schoolError")).hide();e(k.getElement("schoolSucc")).show()};var l=function(n,o){if("placeholder" in document.createElement("input")){e(k.getElement(n)).attr({placeholder:o})}else{e(k.getElement(n+"_placeholder")).show();e(k.getElement(n+"_placeholder")).on("mousedown",function(){k.getElement(n).focus()})}};var g=new Pass.module.regSchool();g.on("selectSchool",function(o,n){k.getElement("school").value=n.schoolName;j()});var i=k.tangram_guid+"__";var h='<p id="'+i+'schoolWrapper" class="pass-form-item pass-form-item-school" style="display:block"><label for="'+i+'school" id="'+i+'schoolLabel" class="pass-label pass-label-school">学校</label><input id="'+i+'school" type="text" name="passport_college_0_school_name" class="pass-text-input pass-text-input-school" autocomplete="off"><span id="'+i+'schoolError" class="pass-item-error pass-item-error-school" style="display: none;">请选择学校</span><span id="'+i+'schoolSucc" class="pass-item-succ pass-item-succ-school" style="display: none;"></span><span id="'+i+'school_placeholder" class="pass-placeholder pass-placeholder-school" style="display: none;">请选择学校</span></p>';e(k.getElement("passwordWrapper")).after(h);e(k.getElement("school")).on("focus",function(){g.show()});e(k.getElement("school")).on("keyup",function(n){n.preventDefault()});e(k.getElement("school")).on("keydown",function(n){n.preventDefault()});e(k.getElement("form")).on("submit",function(){if(k.getElement("school").value){j()}else{f()}});l("school","请选择学校");k.on("beforeSubmit",function(n){if(!k.getElement("school").value||k.getElement("school").value==""){n.returnValue=false}})};if(baidu("#reg_content").length>0){passport.use("reg",{tangram:true},function(f){normalReg=new f.passport.reg(d.options);normalReg.on("render",function(){var g={phone:/^1[34578]\d{9}$/,email:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/};if(d.defaultAccount&&(g.phone.test(d.defaultAccount)||g.email.test(d.defaultAccount))){if(normalReg.getElement("account")){normalReg.getElement("account").value=d.defaultAccount}setTimeout(function(){normalReg.getElement("password").focus()},100)}});normalReg.render("reg_content");c(normalReg)})}if(baidu("#login_btn").length>0){var a,b=false;baidu("#login_btn").on("click",function(){if(!a&&!b){b=true;var f=["qzone","tsina","renren"],g=1;if(d.hasAuthsite=="0"){f=false;g=0}baidu.sio.callByBrowser(document.location.protocol+"//passport.baidu.com/passApi/js/uni_login_wrapper.js?cdnversion=58624634.js?cdnversion="+new Date().getTime(),function(){a=passport.pop.init({tangram:true,cache:true,loginMerge:true,staticPage:d.options.staticPage,color:d.options.color,subpro:d.options.subpro,apiOpt:{product:d.options.product,tangram:false,u:d.options.retu,qrcode:d.options.qrcode,staticPage:d.options.staticPage,sms:g},authsite:f,registerLink:d.options.registerLink});a.show()})}else{if(a){a.show()}}})}setTimeout(function(){if(document.getElementById("mod_feedback")){document.getElementById("mod_feedback").href="http://passport.baidu.com/v2/?ucenterfeedback#reg"}},1000)})(baidu,window.Pass);